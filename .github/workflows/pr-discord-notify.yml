name: PR 알림 디스코드 전송

on:
  pull_request:
    types: [opened, ready_for_review]

jobs:
  notify-discord:
    runs-on: ubuntu-latest
    steps:
      - name: 리뷰어 매핑 및 메시지 생성
        id: set-message
        run: |
          AUTHOR="${{ github.actor }}"
          if [ "$AUTHOR" = "c1vera" ]; then
            echo "content=<@287923007425478668> 님! A(채원)이 PR을 열었어요 🔔\n👉 ${{ github.event.pull_request.html_url }}" >> $GITHUB_OUTPUT
          elif [ "$AUTHOR" = "ckdduf138" ]; then
            echo "content=<@287923007425478668> 님! B(창열)이 PR을 열었어요 🔔\n👉 ${{ github.event.pull_request.html_url }}" >> $GITHUB_OUTPUT
          else
            echo "content=새로운 PR이 생성되었습니다: ${{ github.event.pull_request.html_url }}" >> $GITHUB_OUTPUT
        shell: bash

      - name: 디스코드로 메시지 전송
        uses: Ilshidur/action-discord@master
        with:
          webhook_url: ${{ secrets.DISCORD_WEBHOOK }}
          message: ${{ steps.set-message.outputs.content }}
